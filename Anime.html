<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Anime - The Apothecary Diaries</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link rel="icon" type="image/jpg" href="image/logo.jpeg">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'glass-border': 'rgba(255, 255, 255, 0.2)',
                        'glass-bg': 'rgba(255, 255, 255, 0.2)',
                        'theme-orange': '#ffb26b',
                    },
                    boxShadow: {
                        'glass': '0 4px 30px rgba(0, 0, 0, 0.1)',
                        'glow': '0 0 15px rgba(255, 178, 107, 0.3)',
                    },
                    fontFamily: {
                        sans: ['Segoe UI', 'Tahoma', 'Geneva', 'Verdana', 'sans-serif']
                    }
                }
            }
        }
    </script>

    <style type="text/tailwindcss">
        @layer utilities {
            .glass {
                @apply backdrop-blur-md bg-glass-bg border border-glass-border shadow-glass rounded-2xl;
            }
            .nav-link {
                @apply text-white font-bold text-lg hover:text-theme-orange transition-colors duration-300;
            }
            .watch-btn {
                @apply inline-block px-6 py-2 bg-white text-theme-orange font-bold rounded-lg hover:bg-theme-orange hover:text-white hover:scale-105 transition-all duration-300 cursor-pointer border-none mt-4 no-underline;
            }
        }
    </style>
</head>

<body class="bg-black font-sans min-h-screen text-white relative">

    <img src="image/apothbgland.png" alt="Background"
        class="fixed inset-0 w-full h-full -z-10 hidden md:block opacity-90 transition-opacity duration-700">
    <img src="image/apothbgport.png" alt="Background"
        class="fixed inset-0 w-full h-full -z-10 block md:hidden opacity-90 transition-opacity duration-700">

    <header class="fixed top-0 w-full z-50 px-4 py-3">
        <nav class="glass flex items-center justify-between px-6 py-3 max-w-7xl h-20 mx-auto">
            <div class="flex items-center gap-8">
                <a href="index.html" class="w-20 h-15 overflow-hidden hover:scale-105 transition-transform">
                    <img src="image/logo1.png" alt="Logo" class="w-full h-full ">
                </a>
                <ul class="hidden md:flex gap-8">
                    <li><a href="Anime.html" class="nav-link text-theme-orange">Anime</a></li>
                    <li><a href="manga.html" class="nav-link">Manga</a></li>
                    <li><a href="character.html" class="nav-link">Characters</a></li>
                    <li><a href="about.html" class="nav-link">About</a></li>
                </ul>
            </div>

            <div class="flex items-center gap-4">
                <a id="user-icon-link" href="auth.html"
                    class="w-10 h-10 rounded-full overflow-hidden border border-white/50 hover:border-theme-orange transition-colors">
                    <img id="user-avatar" src="image/accicon.png" alt="Account" class="w-full h-full object-cover">
                </a>
                <button id="mobile-menu-btn" class="md:hidden text-white text-3xl focus:outline-none">≡</button>
            </div>
        </nav>

        <div id="mobile-menu"
            class="hidden absolute top-20 right-4 w-48 glass flex-col items-center py-4 space-y-4 md:hidden">
            <a href="Anime.html" class="nav-link text-base text-theme-orange">Anime</a>
            <a href="manga.html" class="nav-link text-base">Manga</a>
            <a href="character.html" class="nav-link text-base">Characters</a>
            <a href="about.html" class="nav-link text-base">About</a>
        </div>
    </header>

    <main class="pt-32 pb-20 px-4 max-w-7xl mx-auto flex flex-col gap-8">
        <section
            class="glass p-6 flex flex-col md:flex-row items-center gap-8 transition-transform hover:scale-[1.01] duration-300">
            <div class="w-full md:w-1/3 max-w-xs shrink-0 rounded-xl overflow-hidden shadow-lg border border-white/10">
                <img src="image/S1Lgo.jpg" alt="Season 1" class="w-full h-full object-cover">
            </div>
            <div class="flex flex-col gap-4 text-center md:text-left">
                <h2 class="text-3xl font-bold text-theme-orange drop-shadow-md">The Apothecary Diaries – Season 1</h2>
                <p class="text-white font-semibold">Episodes: 24</p>
                <div class="text-white leading-relaxed text-sm md:text-base">
                    <p class="mb-4">
                        Maomao, a young girl working as an apothecary in a red‑light district, is
                        kidnapped and sold to the imperial palace as an indentured servant. She
                        keeps her curious, eccentric nature and secretly investigates the strange
                        illnesses affecting the emperor’s newborns and concubines.
                    </p>
                    <a href="stream.html?season=1" class="watch-btn">Watch Season 1</a>
                </div>
            </div>
        </section>

        <section
            class="glass p-6 flex flex-col md:flex-row items-center gap-8 transition-transform hover:scale-[1.01] duration-300">
            <div class="w-full md:w-1/3 max-w-xs shrink-0 rounded-xl overflow-hidden shadow-lg border border-white/10">
                <img src="image/S2Lgo.webp" alt="Season 2" class="w-full h-full object-cover">
            </div>
            <div class="flex flex-col gap-4 text-center md:text-left">
                <h2 class="text-3xl font-bold text-theme-orange drop-shadow-md">The Apothecary Diaries – Season 2</h2>
                <p class="text-white font-semibold">Episodes: 24</p>
                <div class="text-white leading-relaxed text-sm md:text-base">
                    <p class="mb-4">
                        After solving conspiracies at court and facing the truth about her family,
                        Maomao returns to serve the emperor’s consorts. A visiting merchant
                        caravan brings new intrigue and danger as she uses her medical skill to
                        protect them.
                    </p>
                    <a href="stream.html?season=2" class="watch-btn">Watch Season 2</a>
                </div>
            </div>
        </section>

    </main>

    <footer
        class="mt-auto py-8 text-center text-white/90 text-sm relative z-10 glass rounded-t-2xl mx-auto w-[95%] max-w-7xl mb-4">
        <p class="font-bold">&copy; 2026 The Apothecary Diaries Project.</p>
        <p class="mt-2 px-4 opacity-80 max-w-2xl mx-auto">
            <strong>Disclaimer:</strong> This website is developed strictly for
            <span class="text-theme-orange">educational and portfolio purposes only</span>.
            We do not own the rights to the anime, characters, or media content.
        </p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", async () => {

            const mobileBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            const userIconLink = document.getElementById('user-icon-link');
            const userAvatar = document.getElementById('user-avatar');

            // --- MOBILE MENU ---
            if (mobileBtn && mobileMenu) {
                mobileBtn.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                    mobileMenu.classList.toggle('flex');
                });
            }

            // --- AUTH CHECK ---
            try {
                const res = await fetch('/auth/me?t=' + Date.now(), { credentials: 'include' });
                const data = await res.json();

                if (data.loggedIn && data.user) {
                    const user = data.user;

                    if (userIconLink) {
                        userIconLink.href = (user.role === 'admin') ? 'admin.html' : 'user.html';
                    }

                    if (userAvatar) {
                        let finalSrc;
                        if (user.avatar_id && user.avatar_id !== 'default') {
                            finalSrc = user.avatar_id;
                        } else {
                            const name = user.username || "User";
                            finalSrc = `https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=ffb26b&color=000&bold=true`;
                        }
                        userAvatar.src = finalSrc;
                    }
                } else {
                    // Not logged in
                    if (userIconLink) userIconLink.href = 'auth.html';
                }
            } catch (err) {
                console.error("Auth Check Error:", err);
            }

            // --- LOGOUT ---
            window.logout = async function () {
                try {
                    await fetch('/auth/logout', { method: 'POST', credentials: 'include' });
                    Toastify({ text: "Logged out!", style: { background: "#333" } }).showToast();
                    setTimeout(() => window.location.href = 'index.html', 1000);
                } catch (err) {
                    console.error("Logout failed", err);
                }
            };
        });
    </script>
</body>

</html>